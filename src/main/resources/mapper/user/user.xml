<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cbhb.crb.mapper.user.UserMapper">

	<!-- 根据用户名和密码查找用户 -->
	<select id="getUserByIdAndPassword" parameterType="com.cbhb.crb.bean.LoginUser"
	 		resultType="com.cbhb.crb.bean.LoginUser">
		SELECT 
		  tsu.user_id "userId",
		  tsu.user_name "userName",
		  tsru.role_id "roleId",
		  tsru.org_cd "orgId" 
		FROM
		  t_sys_user tsu 
		  JOIN t_sys_role_user tsru 
		    ON tsru.user_id = tsu.user_id 
		    AND tsru.role_id LIKE 'RP%' 
		WHERE tsu.user_id = #{userId} 
		  AND tsu.password = #{password} 
		ORDER BY tsru.role_id 
		LIMIT 1 
	</select>
</mapper>